{% extends "base.html" %}
{% block content %}

<div class="row">

  <!-- LEFT SIDE -->
  <div class="col-md-4">
    <h3>Upload Document</h3>

    <form method="POST" enctype="multipart/form-data" action="{{ url_for('docs_bp.upload') }}">
      <input class="form-control mt-2" type="file" name="document" required>
      <button class="btn btn-primary btn-sm mt-2" type="submit">Upload</button>
    </form>

    <hr>

    <!-- Action buttons -->
    {% if latest_exists %}
        <!-- ENABLED versions (links) -->
        <a class="btn btn-success btn-sm mt-1"
            href="{{ url_for('docs_bp.summarize_latest') }}">
            Summarize
        </a>

        <a class="btn btn-secondary btn-sm mt-2"
            href="{{ url_for('rag_bp.doubt_resolver') }}">
            Doubt Resolver
        </a>

        <a class="btn btn-warning btn-sm mt-2"
            href="{{ url_for('quiz_bp.start_quiz') }}">
            Quiz Generator
        </a>
        {% else %}
        <!-- DISABLED versions -->
        <button class="btn btn-success btn-sm mt-1" type="button" disabled>Summarize</button>
        <button class="btn btn-secondary btn-sm mt-2" type="button" disabled>Doubt Resolver</button>
        <button class="btn btn-warning btn-sm mt-2" type="button" disabled>Quiz Generator</button>

        <p class="text-muted mt-3">Please upload a document to enable actions.</p>
    {% endif %}

  </div>

  <!-- RIGHT SIDE -->
  <div class="col-md-8">

    {% if extracted_text %}
    <h3>Extracted Text</h3>
    <div class="card mt-3">
      <div class="card-body" style="white-space: pre-wrap; max-height:300px; overflow-y:auto;">
        {{ extracted_text }}
      </div>
    </div>
    {% else %}
    <h5 class="text-muted mt-5">Extracted text will appear here after you upload a document.</h5>
    {% endif %}

    {% if summary %}
    <hr>

    <h4>Summary Stats</h4>
    <table class="table table-bordered" style="max-width:320px;">
      <tr><th>Total Words</th><td>{{ total_words }}</td></tr>
      <tr><th>Summary Words</th><td>{{ summary_words }}</td></tr>
      <tr><th>Ratio</th><td>{{ ratio }}%</td></tr>
    </table>

    <h3 class="mt-3">Summary (â‰ˆ35% words)</h3>
    <div class="card mt-3">
      <div class="card-body" style="white-space: pre-wrap; max-height:250px; overflow-y:auto;">
        {{ summary }}
      </div>
    </div>
    {% endif %}
  </div>
</div>

{% endblock %}
